{"version":3,"file":"diff.js","sourceRoot":"","sources":["diff.ts"],"names":[],"mappings":";;;;;;;;;;;IACA,uCAA8C;IAE9C,SAAS,eAAe,CAAC,KAAU;QAClC,OAAO,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,iBAAiB,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAC5F,CAAC;IAED,SAAgB,MAAM,CAAC,gBAAqB,EAAE,WAAgB;QAC7D,OAAO;YACN,OAAO,EAAE,IAAI;YACb,KAAK,EAAE,WAAW;SAClB,CAAC;IACH,CAAC;IALD,wBAKC;IAED,SAAgB,MAAM,CAAC,gBAAqB,EAAE,WAAgB;QAC7D,OAAO;YACN,OAAO,EAAE,KAAK;YACd,KAAK,EAAE,WAAW;SAClB,CAAC;IACH,CAAC;IALD,wBAKC;IAED,SAAgB,SAAS,CAAC,gBAAqB,EAAE,WAAgB;QAChE,OAAO;YACN,OAAO,EAAE,gBAAgB,KAAK,WAAW;YACzC,KAAK,EAAE,WAAW;SAClB,CAAC;IACH,CAAC;IALD,8BAKC;IAED,SAAgB,OAAO,CAAC,gBAAqB,EAAE,WAAgB,EAAE,KAAS;QAAT,sBAAA,EAAA,SAAS;QACzE,IAAI,OAAO,GAAG,KAAK,CAAC;QAEpB,IAAM,gBAAgB,GAAG,gBAAgB,IAAI,eAAe,CAAC,gBAAgB,CAAC,CAAC;QAC/E,IAAM,gBAAgB,GAAG,WAAW,IAAI,eAAe,CAAC,WAAW,CAAC,CAAC;QAErE,IAAI,CAAC,gBAAgB,IAAI,CAAC,gBAAgB,EAAE;YAC3C,OAAO;gBACN,OAAO,EAAE,IAAI;gBACb,KAAK,EAAE,WAAW;aAClB,CAAC;SACF;QAED,IAAM,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QACnD,IAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAEzC,IAAI,YAAY,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM,EAAE;YAC3C,OAAO,GAAG,IAAI,CAAC;SACf;aAAM;YACN,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,UAAC,GAAG;gBAC1B,IAAI,KAAK,GAAG,CAAC,EAAE;oBACd,OAAO,OAAO,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,gBAAgB,CAAC,GAAG,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC;iBAC3E;gBACD,OAAO,WAAW,CAAC,GAAG,CAAC,KAAK,gBAAgB,CAAC,GAAG,CAAC,CAAC;YACnD,CAAC,CAAC,CAAC;SACH;QACD,OAAO;YACN,OAAO,SAAA;YACP,KAAK,EAAE,WAAW;SAClB,CAAC;IACH,CAAC;IA9BD,0BA8BC;IAED,SAAgB,IAAI,CAAC,gBAAqB,EAAE,WAAgB;QAC3D,IAAI,MAAM,CAAC;QACX,IAAI,OAAO,WAAW,KAAK,UAAU,EAAE;YACtC,IAAI,WAAW,CAAC,KAAK,KAAK,2BAAgB,EAAE;gBAC3C,MAAM,GAAG,SAAS,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;aAClD;iBAAM;gBACN,MAAM,GAAG,MAAM,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;aAC/C;SACD;aAAM,IAAI,eAAe,CAAC,WAAW,CAAC,EAAE;YACxC,MAAM,GAAG,OAAO,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;SAChD;aAAM;YACN,MAAM,GAAG,SAAS,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;SAClD;QACD,OAAO,MAAM,CAAC;IACf,CAAC;IAdD,oBAcC","sourcesContent":["import { PropertyChangeRecord } from './interfaces';\nimport { WIDGET_BASE_TYPE } from './Registry';\n\nfunction isObjectOrArray(value: any): boolean {\n\treturn Object.prototype.toString.call(value) === '[object Object]' || Array.isArray(value);\n}\n\nexport function always(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: true,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function ignore(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: false,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function reference(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\treturn {\n\t\tchanged: previousProperty !== newProperty,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function shallow(previousProperty: any, newProperty: any, depth = 0): PropertyChangeRecord {\n\tlet changed = false;\n\n\tconst validOldProperty = previousProperty && isObjectOrArray(previousProperty);\n\tconst validNewProperty = newProperty && isObjectOrArray(newProperty);\n\n\tif (!validOldProperty || !validNewProperty) {\n\t\treturn {\n\t\t\tchanged: true,\n\t\t\tvalue: newProperty\n\t\t};\n\t}\n\n\tconst previousKeys = Object.keys(previousProperty);\n\tconst newKeys = Object.keys(newProperty);\n\n\tif (previousKeys.length !== newKeys.length) {\n\t\tchanged = true;\n\t} else {\n\t\tchanged = newKeys.some((key) => {\n\t\t\tif (depth > 0) {\n\t\t\t\treturn shallow(newProperty[key], previousProperty[key], depth - 1).changed;\n\t\t\t}\n\t\t\treturn newProperty[key] !== previousProperty[key];\n\t\t});\n\t}\n\treturn {\n\t\tchanged,\n\t\tvalue: newProperty\n\t};\n}\n\nexport function auto(previousProperty: any, newProperty: any): PropertyChangeRecord {\n\tlet result;\n\tif (typeof newProperty === 'function') {\n\t\tif (newProperty._type === WIDGET_BASE_TYPE) {\n\t\t\tresult = reference(previousProperty, newProperty);\n\t\t} else {\n\t\t\tresult = ignore(previousProperty, newProperty);\n\t\t}\n\t} else if (isObjectOrArray(newProperty)) {\n\t\tresult = shallow(previousProperty, newProperty);\n\t} else {\n\t\tresult = reference(previousProperty, newProperty);\n\t}\n\treturn result;\n}\n"]}