{"version":3,"file":"has.mjs","sourceRoot":"","sources":["has.ts"],"names":[],"mappings":"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","sourcesContent":["import global from '../shim/global';\n\n/**\n * The valid return types from a feature test\n */\nexport type FeatureTestResult = boolean | string | number | undefined | void;\n\n/**\n * A function that tests for a feature and returns a result\n */\nexport type FeatureTest = () => FeatureTestResult;\n\n/**\n * A cache of results of feature tests\n */\nexport const testCache: { [feature: string]: FeatureTestResult } = {};\n\n/**\n * A cache of the un-resolved feature tests\n */\nexport const testFunctions: { [feature: string]: FeatureTest } = {};\n\nexport interface StaticHasFeatures {\n\t[feature: string]: FeatureTestResult;\n}\n\nexport interface DojoHasEnvironment {\n\t/**\n\t * Static features defined in the enviornment that should be used by the `has` module\n\t * instead of run-time detection.\n\t */\n\tstaticFeatures?: StaticHasFeatures | (() => StaticHasFeatures);\n}\n\ndeclare global {\n\tinterface Window {\n\t\t/**\n\t\t * The `dojo/has` enviornment which provides configuration when the module is\n\t\t * loaded.\n\t\t */\n\t\tDojoHasEnvironment?: DojoHasEnvironment;\n\t}\n}\n\n/* Grab the staticFeatures if there are available */\nconst { staticFeatures }: DojoHasEnvironment = global.DojoHasEnvironment || {};\n\n/* Cleaning up the DojoHasEnviornment */\nif ('DojoHasEnvironment' in global) {\n\tdelete global.DojoHasEnvironment;\n}\n\n/**\n * Custom type guard to narrow the `staticFeatures` to either a map or a function that\n * returns a map.\n *\n * @param value The value to guard for\n */\nfunction isStaticFeatureFunction(value: any): value is (() => StaticHasFeatures) {\n\treturn typeof value === 'function';\n}\n\n/**\n * The cache of asserted features that were available in the global scope when the\n * module loaded\n */\nconst staticCache: StaticHasFeatures = staticFeatures\n\t? isStaticFeatureFunction(staticFeatures)\n\t\t? staticFeatures.apply(global)\n\t\t: staticFeatures\n\t: {}; /* Providing an empty cache, if none was in the environment\n\n\n/**\n * AMD plugin function.\n *\n * Resolves resourceId into a module id based on possibly-nested tenary expression that branches on has feature test\n * value(s).\n *\n * @param resourceId The id of the module\n * @param normalize Resolves a relative module id into an absolute module id\n */\nexport function normalize(resourceId: string, normalize: (moduleId: string) => string): string | null {\n\tconst tokens: RegExpMatchArray = resourceId.match(/[\\?:]|[^:\\?]*/g) || [];\n\tlet i = 0;\n\n\tfunction get(skip?: boolean): string | null {\n\t\tconst term = tokens[i++];\n\t\tif (term === ':') {\n\t\t\t// empty string module name, resolves to null\n\t\t\treturn null;\n\t\t} else {\n\t\t\t// postfixed with a ? means it is a feature to branch on, the term is the name of the feature\n\t\t\tif (tokens[i++] === '?') {\n\t\t\t\tif (!skip && has(term)) {\n\t\t\t\t\t// matched the feature, get the first value from the options\n\t\t\t\t\treturn get();\n\t\t\t\t} else {\n\t\t\t\t\t// did not match, get the second value, passing over the first\n\t\t\t\t\tget(true);\n\t\t\t\t\treturn get(skip);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// a module\n\t\t\treturn term;\n\t\t}\n\t}\n\n\tconst id = get();\n\n\treturn id && normalize(id);\n}\n\n/**\n * Check if a feature has already been registered\n *\n * @param feature the name of the feature\n */\nexport function exists(feature: string): boolean {\n\tconst normalizedFeature = feature.toLowerCase();\n\n\treturn Boolean(\n\t\tnormalizedFeature in staticCache || normalizedFeature in testCache || testFunctions[normalizedFeature]\n\t);\n}\n\n/**\n * Register a new test for a named feature.\n *\n * @example\n * has.add('dom-addeventlistener', !!document.addEventListener);\n *\n * @example\n * has.add('touch-events', function () {\n *    return 'ontouchstart' in document\n * });\n *\n * @param feature the name of the feature\n * @param value the value reported of the feature, or a function that will be executed once on first test\n * @param overwrite if an existing value should be overwritten. Defaults to false.\n */\nexport function add(feature: string, value: FeatureTest | FeatureTestResult, overwrite: boolean = false): void {\n\tconst normalizedFeature = feature.toLowerCase();\n\n\tif (exists(normalizedFeature) && !overwrite && !(normalizedFeature in staticCache)) {\n\t\tthrow new TypeError(`Feature \"${feature}\" exists and overwrite not true.`);\n\t}\n\n\tif (typeof value === 'function') {\n\t\ttestFunctions[normalizedFeature] = value;\n\t} else {\n\t\ttestCache[normalizedFeature] = value;\n\t\tdelete testFunctions[normalizedFeature];\n\t}\n}\n\n/**\n * Return the current value of a named feature.\n *\n * @param feature The name of the feature to test.\n */\nexport default function has(feature: string, strict: boolean = false): FeatureTestResult {\n\tlet result: FeatureTestResult;\n\n\tconst normalizedFeature = feature.toLowerCase();\n\n\tif (normalizedFeature in staticCache) {\n\t\tresult = staticCache[normalizedFeature];\n\t} else if (testFunctions[normalizedFeature]) {\n\t\tresult = testCache[normalizedFeature] = testFunctions[normalizedFeature].call(null);\n\t\tdelete testFunctions[normalizedFeature];\n\t} else if (normalizedFeature in testCache) {\n\t\tresult = testCache[normalizedFeature];\n\t} else if (strict) {\n\t\tthrow new TypeError(`Attempt to detect unregistered has feature \"${feature}\"`);\n\t}\n\n\treturn result;\n}\n\n/*\n * Out of the box feature tests\n */\nadd('public-path', undefined);\n\n/* flag for dojo debug, default to false */\nadd('dojo-debug', false);\n\n/* Detects if the environment is \"browser like\" */\nadd('host-browser', typeof document !== 'undefined' && typeof location !== 'undefined');\n\n/* Detects if the environment appears to be NodeJS */\nadd('host-node', function() {\n\tif (typeof process === 'object' && process.versions && process.versions.node) {\n\t\treturn process.versions.node;\n\t}\n});\n\nadd('fetch', 'fetch' in global && typeof global.fetch === 'function', true);\n\nadd(\n\t'es6-array',\n\t() => {\n\t\treturn (\n\t\t\t['from', 'of'].every((key) => key in global.Array) &&\n\t\t\t['findIndex', 'find', 'copyWithin'].every((key) => key in global.Array.prototype)\n\t\t);\n\t},\n\ttrue\n);\n\nadd(\n\t'es6-array-fill',\n\t() => {\n\t\tif ('fill' in global.Array.prototype) {\n\t\t\t/* Some versions of Safari do not properly implement this */\n\t\t\treturn ([1] as any).fill(9, Number.POSITIVE_INFINITY)[0] === 1;\n\t\t}\n\t\treturn false;\n\t},\n\ttrue\n);\n\nadd('es7-array', () => 'includes' in global.Array.prototype, true);\n\n/* Map */\nadd(\n\t'es6-map',\n\t() => {\n\t\tif (typeof global.Map === 'function') {\n\t\t\t/*\n\t\tIE11 and older versions of Safari are missing critical ES6 Map functionality\n\t\tWe wrap this in a try/catch because sometimes the Map constructor exists, but does not\n\t\ttake arguments (iOS 8.4)\n\t\t */\n\t\t\ttry {\n\t\t\t\tconst map = new global.Map([[0, 1]]);\n\n\t\t\t\treturn (\n\t\t\t\t\tmap.has(0) &&\n\t\t\t\t\ttypeof map.keys === 'function' &&\n\t\t\t\t\thas('es6-symbol') &&\n\t\t\t\t\ttypeof map.values === 'function' &&\n\t\t\t\t\ttypeof map.entries === 'function'\n\t\t\t\t);\n\t\t\t} catch (e) {\n\t\t\t\t/* istanbul ignore next: not testing on iOS at the moment */\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\ttrue\n);\n\nadd('es6-iterator', () => has('es6-map'));\n\n/* Math */\nadd(\n\t'es6-math',\n\t() => {\n\t\treturn [\n\t\t\t'clz32',\n\t\t\t'sign',\n\t\t\t'log10',\n\t\t\t'log2',\n\t\t\t'log1p',\n\t\t\t'expm1',\n\t\t\t'cosh',\n\t\t\t'sinh',\n\t\t\t'tanh',\n\t\t\t'acosh',\n\t\t\t'asinh',\n\t\t\t'atanh',\n\t\t\t'trunc',\n\t\t\t'fround',\n\t\t\t'cbrt',\n\t\t\t'hypot'\n\t\t].every((name) => typeof global.Math[name] === 'function');\n\t},\n\ttrue\n);\n\nadd(\n\t'es6-math-imul',\n\t() => {\n\t\tif ('imul' in global.Math) {\n\t\t\t/* Some versions of Safari on ios do not properly implement this */\n\t\t\treturn (Math as any).imul(0xffffffff, 5) === -5;\n\t\t}\n\t\treturn false;\n\t},\n\ttrue\n);\n\n/* Object */\nadd(\n\t'es6-object',\n\t() => {\n\t\treturn (\n\t\t\thas('es6-symbol') &&\n\t\t\t['assign', 'is', 'getOwnPropertySymbols', 'setPrototypeOf'].every(\n\t\t\t\t(name) => typeof global.Object[name] === 'function'\n\t\t\t)\n\t\t);\n\t},\n\ttrue\n);\n\nadd(\n\t'es2017-object',\n\t() => {\n\t\treturn ['values', 'entries', 'getOwnPropertyDescriptors'].every(\n\t\t\t(name) => typeof global.Object[name] === 'function'\n\t\t);\n\t},\n\ttrue\n);\n\n/* Observable */\nadd('es-observable', () => typeof global.Observable !== 'undefined', true);\n\n/* Promise */\nadd('es6-promise', () => typeof global.Promise !== 'undefined' && has('es6-symbol'), true);\n\nadd(\n\t'es2018-promise-finally',\n\t() => has('es6-promise') && typeof global.Promise.prototype.finally !== 'undefined',\n\ttrue\n);\n\n/* Set */\nadd(\n\t'es6-set',\n\t() => {\n\t\tif (typeof global.Set === 'function') {\n\t\t\t/* IE11 and older versions of Safari are missing critical ES6 Set functionality */\n\t\t\tconst set = new global.Set([1]);\n\t\t\treturn set.has(1) && 'keys' in set && typeof set.keys === 'function' && has('es6-symbol');\n\t\t}\n\t\treturn false;\n\t},\n\ttrue\n);\n\n/* String */\nadd(\n\t'es6-string',\n\t() => {\n\t\treturn (\n\t\t\t[\n\t\t\t\t/* static methods */\n\t\t\t\t'fromCodePoint'\n\t\t\t].every((key) => typeof global.String[key] === 'function') &&\n\t\t\t[\n\t\t\t\t/* instance methods */\n\t\t\t\t'codePointAt',\n\t\t\t\t'normalize',\n\t\t\t\t'repeat',\n\t\t\t\t'startsWith',\n\t\t\t\t'endsWith',\n\t\t\t\t'includes'\n\t\t\t].every((key) => typeof global.String.prototype[key] === 'function')\n\t\t);\n\t},\n\ttrue\n);\n\nadd(\n\t'es6-string-raw',\n\t() => {\n\t\tfunction getCallSite(callSite: TemplateStringsArray, ...substitutions: any[]) {\n\t\t\tconst result = [...callSite];\n\t\t\t(result as any).raw = callSite.raw;\n\t\t\treturn result;\n\t\t}\n\n\t\tif ('raw' in global.String) {\n\t\t\tlet b = 1;\n\t\t\tlet callSite = getCallSite`a\\n${b}`;\n\n\t\t\t(callSite as any).raw = ['a\\\\n'];\n\t\t\tconst supportsTrunc = global.String.raw(callSite, 42) === 'a\\\\n';\n\n\t\t\treturn supportsTrunc;\n\t\t}\n\n\t\treturn false;\n\t},\n\ttrue\n);\n\nadd(\n\t'es2017-string',\n\t() => {\n\t\treturn ['padStart', 'padEnd'].every((key) => typeof global.String.prototype[key] === 'function');\n\t},\n\ttrue\n);\n\n/* Symbol */\nadd('es6-symbol', () => typeof global.Symbol !== 'undefined' && typeof Symbol() === 'symbol', true);\n\n/* WeakMap */\nadd(\n\t'es6-weakmap',\n\t() => {\n\t\tif (typeof global.WeakMap !== 'undefined') {\n\t\t\t/* IE11 and older versions of Safari are missing critical ES6 Map functionality */\n\t\t\tconst key1 = {};\n\t\t\tconst key2 = {};\n\t\t\tconst map = new global.WeakMap([[key1, 1]]);\n\t\t\tObject.freeze(key1);\n\t\t\treturn map.get(key1) === 1 && map.set(key2, 2) === map && has('es6-symbol');\n\t\t}\n\t\treturn false;\n\t},\n\ttrue\n);\n\n/* Miscellaneous features */\nadd('microtasks', () => has('es6-promise') || has('host-node') || has('dom-mutationobserver'), true);\nadd(\n\t'postmessage',\n\t() => {\n\t\t// If window is undefined, and we have postMessage, it probably means we're in a web worker. Web workers have\n\t\t// post message but it doesn't work how we expect it to, so it's best just to pretend it doesn't exist.\n\t\treturn typeof global.window !== 'undefined' && typeof global.postMessage === 'function';\n\t},\n\ttrue\n);\nadd('raf', () => typeof global.requestAnimationFrame === 'function', true);\nadd('setimmediate', () => typeof global.setImmediate !== 'undefined', true);\n\n/* DOM Features */\n\nadd(\n\t'dom-mutationobserver',\n\t() => {\n\t\tif (has('host-browser') && Boolean(global.MutationObserver || global.WebKitMutationObserver)) {\n\t\t\t// IE11 has an unreliable MutationObserver implementation where setProperty() does not\n\t\t\t// generate a mutation event, observers can crash, and the queue does not drain\n\t\t\t// reliably. The following feature test was adapted from\n\t\t\t// https://gist.github.com/t10ko/4aceb8c71681fdb275e33efe5e576b14\n\t\t\tconst example = document.createElement('div');\n\t\t\t/* tslint:disable-next-line:variable-name */\n\t\t\tconst HostMutationObserver = global.MutationObserver || global.WebKitMutationObserver;\n\t\t\tconst observer = new HostMutationObserver(function() {});\n\t\t\tobserver.observe(example, { attributes: true });\n\n\t\t\texample.style.setProperty('display', 'block');\n\n\t\t\treturn Boolean(observer.takeRecords().length);\n\t\t}\n\t\treturn false;\n\t},\n\ttrue\n);\n\nadd(\n\t'dom-webanimation',\n\t() => has('host-browser') && global.Animation !== undefined && global.KeyframeEffect !== undefined,\n\ttrue\n);\n\nadd('abort-controller', () => typeof global.AbortController !== 'undefined');\n\nadd('abort-signal', () => typeof global.AbortSignal !== 'undefined');\n\nadd('dom-intersection-observer', () => has('host-browser') && global.IntersectionObserver !== undefined, true);\n\nadd('dom-resize-observer', () => has('host-browser') && global.ResizeObserver !== undefined, true);\n\nadd('dom-pointer-events', () => has('host-browser') && global.onpointerdown !== undefined, true);\n\nadd('build-elide', false);\n\nadd('test', false);\n\nadd('global-this', () => typeof global.globalThis !== 'undefined');\n"]}