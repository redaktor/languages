{"version":3,"file":"compare.js","sourceRoot":"","sources":["compare.ts"],"names":[],"mappings":";;;;;;;;;;;;IAAA,sCAAiC;IACjC,0CAAwC;IAExC,SAAgB,QAAQ,CAAC,KAAU;QAClC,OAAO,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,iBAAiB,CAAC;IACpE,CAAC;IAFD,4BAEC;IAED,SAAgB,OAAO,CAAC,CAAM,EAAE,CAAM;QACrC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;YACzC,OAAO,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,KAAK,CAAC,UAAC,OAAY,EAAE,CAAS,IAAK,OAAA,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAtB,CAAsB,CAAC,CAAC;SAC7F;aAAM,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;YACtC,IAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YACvC,IAAM,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;YACvC,OAAO,OAAO,CAAC,QAAQ,EAAE,QAAQ,CAAC,IAAI,QAAQ,CAAC,KAAK,CAAC,UAAC,GAAG,IAAK,OAAA,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,EAAvB,CAAuB,CAAC,CAAC;SACvF;aAAM;YACN,OAAO,CAAC,KAAK,CAAC,CAAC;SACf;IACF,CAAC;IAVD,0BAUC;IAED,SAAS,mBAAmB,CAAC,CAAQ,EAAE,CAAQ;QAC9C,IAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;QACzC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;YAC7B,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;gBACzB,OAAO,CAAC,CAAC;aACT;SACD;QAED,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,MAAM,EAAE;YAC1B,OAAO,GAAG,CAAC;SACX;QAED,OAAO,CAAC,CAAC,CAAC;IACX,CAAC;IAED,SAAS,8BAA8B,CAAC,CAAyB,EAAE,CAAyB;;QAC3F,IAAM,IAAI,GAAG,YAAI,CAAC,IAAI,aAAG,kBAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAK,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC;;YAE5E,KAAgB,IAAA,SAAA,iBAAA,IAAI,CAAA,0BAAA,4CAAE;gBAAjB,IAAI,GAAG,iBAAA;gBACX,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE;oBAC7B,OAAO,GAAG,CAAC;iBACX;aACD;;;;;;;;;IACF,CAAC;IAED,SAAgB,4BAA4B,CAAC,QAAa,EAAE,MAAW;QACtE,IAAM,UAAU,GAAG,mBAAmB,CAAC,MAAM,CAAC,CAAC;QAC/C,IAAM,YAAY,GAAG,mBAAmB,CAAC,QAAQ,CAAC,CAAC;QAEnD,IAAI,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YACrD,IAAM,MAAM,GAAG,mBAAmB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAErD,IAAI,MAAM,KAAK,CAAC,CAAC,EAAE;gBAClB,OAAO,+BAA6B,MAAQ,CAAC;aAC7C;YACD,OAAO,sBAAsB,CAAC;SAC9B;aAAM,IAAI,QAAQ,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE;YAClD,IAAM,GAAG,GAAG,8BAA8B,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAE7D,IAAI,GAAG,EAAE;gBACR,IAAM,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC;gBACpC,IAAM,WAAW,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;gBAChC,OAAO,gBAAa,aAAa,+BAAyB,GAAG,mBAAa,WAAW,eAAW,CAAC;aACjG;YACD,OAAO,uBAAuB,CAAC;SAC/B;aAAM,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,MAAM,CAAC,EAAE;YACtC,IAAI,UAAU,KAAK,YAAY,EAAE;gBAChC,OAAO,gBAAa,QAAQ,qBAAc,MAAM,eAAW,CAAC;aAC5D;iBAAM;gBACN,OAAO,cAAY,YAAY,WAAK,QAAQ,mBAAa,UAAU,WAAK,MAAM,eAAW,CAAC;aAC1F;SACD;QAED,OAAO,sBAAsB,CAAC;IAC/B,CAAC;IA7BD,oEA6BC;IAED,SAAS,mBAAmB,CAAC,KAAU;QACtC,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;YACzB,OAAO,OAAO,CAAC;SACf;QACD,OAAO,OAAO,KAAK,CAAC;IACrB,CAAC","sourcesContent":["import Set from '../../shim/Set';\nimport { from } from '../../shim/array';\n\nexport function isObject(value: any): value is Object {\n\treturn Object.prototype.toString.call(value) === '[object Object]';\n}\n\nexport function isEqual(a: any, b: any): boolean {\n\tif (Array.isArray(a) && Array.isArray(b)) {\n\t\treturn a.length === b.length && a.every((element: any, i: number) => isEqual(element, b[i]));\n\t} else if (isObject(a) && isObject(b)) {\n\t\tconst keysForA = Object.keys(a).sort();\n\t\tconst keysForB = Object.keys(b).sort();\n\t\treturn isEqual(keysForA, keysForB) && keysForA.every((key) => isEqual(a[key], b[key]));\n\t} else {\n\t\treturn a === b;\n\t}\n}\n\nfunction findArrayDifference(a: any[], b: any[]): number {\n\tconst min = Math.min(a.length, b.length);\n\tfor (let i = 0; i < min; i++) {\n\t\tif (!isEqual(a[i], b[i])) {\n\t\t\treturn i;\n\t\t}\n\t}\n\n\tif (a.length !== b.length) {\n\t\treturn min;\n\t}\n\n\treturn -1;\n}\n\nfunction findShallowObjectKeyDifference(a: { [key: string]: any }, b: { [key: string]: any }): string | undefined {\n\tconst keys = from(new Set([...Object.keys(a), ...Object.keys(b)]).values());\n\n\tfor (let key of keys) {\n\t\tif (!isEqual(a[key], b[key])) {\n\t\t\treturn key;\n\t\t}\n\t}\n}\n\nexport function getFriendlyDifferenceMessage(expected: any, actual: any): string {\n\tconst actualType = getFriendlyTypeName(actual);\n\tconst expectedType = getFriendlyTypeName(expected);\n\n\tif (Array.isArray(expected) && Array.isArray(actual)) {\n\t\tconst offset = findArrayDifference(expected, actual);\n\n\t\tif (offset !== -1) {\n\t\t\treturn `Arrays differed at offset ${offset}`;\n\t\t}\n\t\treturn 'Arrays are identical';\n\t} else if (isObject(expected) && isObject(actual)) {\n\t\tconst key = findShallowObjectKeyDifference(expected, actual);\n\n\t\tif (key) {\n\t\t\tconst expectedValue = expected[key];\n\t\t\tconst actualValue = actual[key];\n\t\t\treturn `Expected \"${expectedValue}\" for object property ${key} but got \"${actualValue}\" instead`;\n\t\t}\n\t\treturn 'Objects are identical';\n\t} else if (!isEqual(expected, actual)) {\n\t\tif (actualType === expectedType) {\n\t\t\treturn `Expected \"${expected}\" but got \"${actual}\" instead`;\n\t\t} else {\n\t\t\treturn `Expected ${expectedType} \"${expected}\" but got ${actualType} \"${actual}\" instead`;\n\t\t}\n\t}\n\n\treturn 'Values are identical';\n}\n\nfunction getFriendlyTypeName(value: any): string {\n\tif (Array.isArray(value)) {\n\t\treturn 'array';\n\t}\n\treturn typeof value;\n}\n"]}